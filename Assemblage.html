<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Assemblage" rel="Chapter" href="Assemblage.html"><link title="Features and flags" rel="Section" href="#featuresandflags">
<link title="Resolvers" rel="Section" href="#resolvers">
<link title="Custom Actions" rel="Section" href="#actions">
<link title="Components" rel="Section" href="#comps">
<link title="Component helpers" rel="Section" href="#componenthelpers">
<link title="Projects" rel="Section" href="#projects">
<link title="Build Environments" rel="Section" href="#buildenv">
<link title="Commands" rel="Section" href="#commands">
<title>Assemblage</title>
</head>
<body>
<div class="navbar">&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;</div>
<h1>Module <a href="type_Assemblage.html">Assemblage</a></h1>

<pre><span class="keyword">module</span> Assemblage: <code class="code"><span class="keyword">sig</span></code> <a href="Assemblage.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
The Assemblage Library.
<p>

    <code class="code"><span class="constructor">Assemblage</span></code> provides a simple embedded domain specific language
    to describe <code class="code"><span class="constructor">OCaml</span></code> <a href="Assemblage.html#projects">projects</a>. It also provides simple
    tools to configure, manage, install and use OCaml projects.
<p>

    Describing a project eventually leads to describe its build
    artifacts. The exact mapping betweem project elements and those
    build artifacts depends on the presence or absence of
    <a href="Assemblage.Features.html">features</a>. Examples of such features are weather to
    compile and run the tests (user-defined feature), the presence of
    the native compiler (system-dependant feature), compiling a
    library using <code class="code">async</code> or <code class="code">lwt</code> as a backend (environment-dependant
    feature), ...
<p>

    Finally, generating build artifacts means refining the project
    description into concrete <a href="Assemblage.Flags.html">command line arguments</a> to pass
    to the different compilers (<code class="code">ocamlc</code>, <code class="code">ocamlopt</code>) on the different
    compilation and linking phases.
<p>

    <em>Release %%VERSION%% - %%AUTHOR%% </em><br>
</div>
<hr width="100%">
<br>
<h1 id="featuresandflags">Features and flags</h1><br>

<pre><span class="keyword">module</span> <a href="Assemblage.Features.html">Features</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Assemblage.Features.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Features.
</div>

<pre><span class="keyword">module</span> <a href="Assemblage.Flags.html">Flags</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Assemblage.Flags.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Flags
</div>
<br>
<h1 id="resolvers">Resolvers</h1><br>
<br>
A project defines different kinds of names: local and external
    library names. A local library name needs to be associated with
    the name of the local directory where the build artifacts for that
    library are created and an external library name needs to be
    associated with the global directory where the object files for
    that library are installed.<br>

<pre><span class="keyword">module</span> <a href="Assemblage.Resolver.html">Resolver</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Assemblage.Resolver.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><br>
<h1 id="actions">Custom Actions</h1><br>

<pre><span class="keyword">module</span> <a href="Assemblage.Action.html">Action</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Assemblage.Action.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><br>
<h1 id="comps">Components</h1>
<p>

    A project is a set of components. Each component describes a
    logical build unit like a compilation unit, a library, a binary, a
    test, the documentation of a library, etc. A component can depend
    on other components, either because it needs the dependencies to
    be part of it or because it needs them to be build.<br>

<pre><span id="TYPEcomp_unit"><span class="keyword">type</span> <code class="type"></code>comp_unit</span> </pre>
<div class="info ">
The type for compilation unit descriptions.<br>
</div>


<pre><span id="TYPEother"><span class="keyword">type</span> <code class="type"></code>other</span> </pre>
<div class="info ">
The type for arbitrarily constructed files descriptions.<br>
</div>


<pre><span id="TYPEpkg"><span class="keyword">type</span> <code class="type"></code>pkg</span> </pre>
<div class="info ">
The type for package descriptions.<br>
</div>


<pre><span id="TYPElib"><span class="keyword">type</span> <code class="type"></code>lib</span> </pre>
<div class="info ">
The type for library descriptions.<br>
</div>


<pre><span id="TYPEbin"><span class="keyword">type</span> <code class="type"></code>bin</span> </pre>
<div class="info ">
The type for binary executable descriptions.<br>
</div>


<pre><span id="TYPEcontainer"><span class="keyword">type</span> <code class="type"></code>container</span> </pre>
<div class="info ">
The type for containers of components.<br>
</div>


<pre><span id="TYPEtest"><span class="keyword">type</span> <code class="type"></code>test</span> </pre>
<div class="info ">
The type for test descriptions.<br>
</div>


<pre><span id="TYPEdoc"><span class="keyword">type</span> <code class="type"></code>doc</span> </pre>
<div class="info ">
The type for documentation descriptions.<br>
</div>


<pre><span id="TYPEcomponent"><span class="keyword">type</span> <code class="type"></code>component</span> = <code class="type">[ `Bin of <a href="Assemblage.html#TYPEbin">bin</a><br>       | `Container of <a href="Assemblage.html#TYPEcontainer">container</a><br>       | `Doc of <a href="Assemblage.html#TYPEdoc">doc</a><br>       | `Lib of <a href="Assemblage.html#TYPElib">lib</a><br>       | `Other of <a href="Assemblage.html#TYPEother">other</a><br>       | `Pkg of <a href="Assemblage.html#TYPEpkg">pkg</a><br>       | `Test of <a href="Assemblage.html#TYPEtest">test</a><br>       | `Unit of <a href="Assemblage.html#TYPEcomp_unit">comp_unit</a> ]</code> </pre>
<div class="info ">
The type for components.
    <ul>
<li><code class="code"><span class="keywordsign">`</span><span class="constructor">Unit</span> u</code> u is a project compilation unit.</li>
<li><code class="code"><span class="keywordsign">`</span><span class="constructor">Lib</span> l</code> is a project library.</li>
<li><code class="code"><span class="keywordsign">`</span><span class="constructor">Bin</span> b</code> is a project binary.</li>
<li><code class="code"><span class="keywordsign">`</span><span class="constructor">Test</span> b</code> is a project test.</li>
<li><code class="code"><span class="keywordsign">`</span><span class="constructor">Pkg</span> p</code> is an external named package.</li>
<li>FIXME</li>
</ul>
<br>
</div>


<pre><span id="VALunit"><span class="keyword">val</span> unit</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       string -><br>       [ `Other of <a href="Assemblage.html#TYPEother">other</a> | `Path of string list ] -><br>       [> `Unit of <a href="Assemblage.html#TYPEcomp_unit">comp_unit</a> ]</code></pre><div class="info ">
<code class="code">unit name dir ~available ~flags ~deps</code> is a compilation unit
    named <code class="code">name</code> (the filename without extension) present in directory
    <code class="code">dir</code>.  It is only available whenever <code class="code">available</code> is true, it must
    be build with <code class="code">flags</code> and depends on <code class="code">deps</code> to be built.<br>
</div>

<pre><span id="VALpack"><span class="keyword">val</span> pack</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       string -><br>       [ `Unit of <a href="Assemblage.html#TYPEcomp_unit">comp_unit</a> ] list -> [> `Unit of <a href="Assemblage.html#TYPEcomp_unit">comp_unit</a> ]</code></pre><div class="info ">
Pack compilation units together.<br>
</div>

<pre><span id="VALc"><span class="keyword">val</span> c</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       ?cclib:string list -><br>       ?ccopt:string list -><br>       string -><br>       [ `Other of <a href="Assemblage.html#TYPEother">other</a> | `Path of string list ] -><br>       [> `Unit of <a href="Assemblage.html#TYPEcomp_unit">comp_unit</a> ]</code></pre><div class="info ">
Same as <a href="Assemblage.html#VALunit"><code class="code"><span class="constructor">Assemblage</span>.unit</code></a> but for C source files.<br>
</div>

<pre><span id="VALjs"><span class="keyword">val</span> js</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       ?jsflags:string list -><br>       string -><br>       [ `Other of <a href="Assemblage.html#TYPEother">other</a> | `Path of string list ] -><br>       [> `Unit of <a href="Assemblage.html#TYPEcomp_unit">comp_unit</a> ]</code></pre><div class="info ">
Same as <a href="Assemblage.html#VALunit"><code class="code"><span class="constructor">Assemblage</span>.unit</code></a> but for javascript source files.<br>
</div>

<pre><span id="VALother"><span class="keyword">val</span> other</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       string -><br>       <a href="Assemblage.html#TYPEcomponent">component</a> <a href="Assemblage.Action.html#TYPErule">Action.rule</a> list -><br>       [> `Other of <a href="Assemblage.html#TYPEother">other</a> ]</code></pre><div class="info ">
Generated source file(s).<br>
</div>

<pre><span id="VALlib"><span class="keyword">val</span> lib</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       ?pack:bool -><br>       string -><br>       [ `Other of <a href="Assemblage.html#TYPEother">other</a><br>       | `Units of [ `Unit of <a href="Assemblage.html#TYPEcomp_unit">comp_unit</a> ] list ] -><br>       [> `Lib of <a href="Assemblage.html#TYPElib">lib</a> ]</code></pre><div class="info ">
<code class="code">lib name units</code> is the project library <code class="code">name</code> composed by the compilation
    units <code class="code">cus</code>. If <code class="code">lib</code> is set, use <code class="code">ocamldep</code> to approximate the
    compilation units and their dependecies in the given directory.<br>
</div>

<pre><span id="VALlib_pp"><span class="keyword">val</span> lib_pp</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       ?pack:bool -><br>       string -><br>       [ `Other of <a href="Assemblage.html#TYPEother">other</a><br>       | `Units of [ `Unit of <a href="Assemblage.html#TYPEcomp_unit">comp_unit</a> ] list ] -><br>       [> `Lib of <a href="Assemblage.html#TYPElib">lib</a> ]</code></pre><div class="info ">
<code class="code">lib_pp</code> is like <a href="Assemblage.html#VALlib"><code class="code"><span class="constructor">Assemblage</span>.lib</code></a> but it defines a project pre-processor.<br>
</div>

<pre><span id="VALbin"><span class="keyword">val</span> bin</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       ?byte:bool -><br>       ?native:bool -><br>       ?js:bool -><br>       ?link_all:bool -><br>       ?install:bool -><br>       string -><br>       [ `Other of <a href="Assemblage.html#TYPEother">other</a><br>       | `Units of [ `Unit of <a href="Assemblage.html#TYPEcomp_unit">comp_unit</a> ] list ] -><br>       [> `Bin of <a href="Assemblage.html#TYPEbin">bin</a> ]</code></pre><div class="info ">
<code class="code">bin name units</code> is the binary <code class="code">name</code> obtained by compiling
    the compilation units <code class="code">units</code>, with the dependencies <code class="code">deps</code>. By
    default, the source files are located into <i>bin/</i> (this is
    controled by the value of <code class="code">dir</code>).<br>
</div>

<pre><span id="VALcontainer"><span class="keyword">val</span> container</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       string -><br>       <a href="Assemblage.html#TYPEcomponent">component</a> list -> [> `Container of <a href="Assemblage.html#TYPEcontainer">container</a> ]</code></pre><div class="info ">
FIXME: doc<br>
</div>

<pre><span id="VALpkg"><span class="keyword">val</span> pkg</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?opt:bool -> string -> [> `Pkg of <a href="Assemblage.html#TYPEpkg">pkg</a> ]</code></pre><div class="info ">
<code class="code">pkg available opt name</code> is an external OCaml package named <code class="code">name</code>. It is
    only available whenever <code class="code">available</code> is true. If <code class="code">opt</code> is true (defaults
    to <code class="code"><span class="keyword">false</span></code>) a feature <code class="code">f</code> is automatically created for the package
    and anded to <code class="code">available</code>.<br>
</div>

<pre><span id="VALpkg_pp"><span class="keyword">val</span> pkg_pp</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?opt:bool -> string -> [> `Pkg of <a href="Assemblage.html#TYPEpkg">pkg</a> ]</code></pre><div class="info ">
<code class="code">pkg_pp available opt name</code> is like <a href="Assemblage.html#VALpkg"><code class="code"><span class="constructor">Assemblage</span>.pkg</code></a> except it denotes
    an external OCaml pre-processor package.<br>
</div>

<pre><span id="VALpkg_c"><span class="keyword">val</span> pkg_c</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?opt:bool -> string -> [> `Pkg of <a href="Assemblage.html#TYPEpkg">pkg</a> ]</code></pre><div class="info ">
<code class="code">pkg_c available opt name</code> is like <a href="Assemblage.html#VALpkg"><code class="code"><span class="constructor">Assemblage</span>.pkg</code></a> except it denotes an
    external C package.<br>
</div>

<pre><span id="TYPEtest_command"><span class="keyword">type</span> <code class="type"></code>test_command</span> </pre>
<div class="info ">
The type for test commands.<br>
</div>


<pre><span id="TYPEtest_args"><span class="keyword">type</span> <code class="type"></code>test_args</span> = <code class="type"><a href="Assemblage.Resolver.html#TYPEt">Resolver.t</a> -> string list</code> </pre>
<div class="info ">
The type for command line arguments when calling tests of executable.<br>
</div>


<pre><span id="VALtest_bin"><span class="keyword">val</span> test_bin</span> : <code class="type">[ `Bin of <a href="Assemblage.html#TYPEbin">bin</a> ] -><br>       ?args:<a href="Assemblage.html#TYPEtest_args">test_args</a> -> unit -> <a href="Assemblage.html#TYPEtest_command">test_command</a></code></pre><div class="info ">
A test which runs a binary built in the project.<br>
</div>

<pre><span id="VALtest_shell"><span class="keyword">val</span> test_shell</span> : <code class="type">('a, unit, string, <a href="Assemblage.html#TYPEtest_command">test_command</a>) Pervasives.format4 -> 'a</code></pre><div class="info ">
A test which runs an arbitrary shell command.<br>
</div>

<pre><span id="VALtest"><span class="keyword">val</span> test</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       ?dir:string -><br>       string -> <a href="Assemblage.html#TYPEtest_command">test_command</a> list -> [> `Test of <a href="Assemblage.html#TYPEtest">test</a> ]</code></pre><div class="info ">
Description of a test.<br>
</div>

<pre><span id="VALdoc"><span class="keyword">val</span> doc</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       ?install:bool -><br>       string -> <a href="Assemblage.html#TYPEcomponent">component</a> list -> [> `Doc of <a href="Assemblage.html#TYPEdoc">doc</a> ]</code></pre><div class="info ">
Description of documentation files.<br>
</div>
<br>
<h1 id="componenthelpers">Component helpers</h1><br>

<pre><span id="VALpick"><span class="keyword">val</span> pick</span> : <code class="type">string -> <a href="Assemblage.html#TYPEcomponent">component</a> -> <a href="Assemblage.html#TYPEcomponent">component</a></code></pre><div class="info ">
<code class="code">unit_in c name</code> is the unit named <code class="code">name</code> is the component
    <code class="code">c</code>. Raise <code class="code"><span class="constructor">Not_found</span></code> if not unit has this name.<br>
</div>

<pre><span id="VALbuild_dir"><span class="keyword">val</span> build_dir</span> : <code class="type"><a href="Assemblage.html#TYPEcomponent">component</a> -> <a href="Assemblage.Resolver.html#TYPEt">Resolver.t</a> -> string</code></pre><div class="info ">
<code class="code">build_dir t r</code> is the directory where the component <code class="code">t</code> is
    built.<br>
</div>

<pre><span id="VALroot_dir"><span class="keyword">val</span> root_dir</span> : <code class="type"><a href="Assemblage.Resolver.html#TYPEt">Resolver.t</a> -> string</code></pre><div class="info ">
<code class="code">root_dir r</code> is the root directory of the project.<br>
</div>

<pre><span id="VALcstubs"><span class="keyword">val</span> cstubs</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?deps:<a href="Assemblage.html#TYPEcomponent">component</a> list -><br>       ?headers:string list -><br>       ?cflags:string list -><br>       ?clibs:string list -><br>       string -> [ `Path of string list ] -> [> `Lib of <a href="Assemblage.html#TYPElib">lib</a> ]</code></pre><div class="info ">
<code class="code">stubs name dir</code> is the C stub generations, using Ctypes, of the
    compilation unit <code class="code">name</code>. The <code class="code"><span class="constructor">Name_bindings</span></code> module should be
    located in <code class="code">dir</code>.<br>
</div>
<br>
<h1 id="projects">Projects</h1><br>

<pre><span id="TYPEproject"><span class="keyword">type</span> <code class="type"></code>project</span> </pre>
<div class="info ">
The type for OCaml projects descriptions. Simply a set of
    components.<br>
</div>


<pre><span id="VALproject"><span class="keyword">val</span> project</span> : <code class="type">?available:<a href="Assemblage.Features.html#TYPEt">Features.t</a> -><br>       ?flags:<a href="Assemblage.Flags.html#TYPEt">Flags.t</a> -><br>       ?version:string -> string -> <a href="Assemblage.html#TYPEcomponent">component</a> list -> <a href="Assemblage.html#TYPEproject">project</a></code></pre><div class="info ">
<code class="code">project name comps</code>  TODO<br>
</div>
<br>
<h1 id="buildenv">Build Environments</h1><br>

<pre><span class="keyword">module</span> <a href="Assemblage.Build_env.html">Build_env</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Assemblage.Build_env.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><br>
<h1 id="commands">Commands</h1><br>

<pre><span id="VALassemble"><span class="keyword">val</span> assemble</span> : <code class="type"><a href="Assemblage.html#TYPEproject">project</a> -> unit</code></pre><div class="info ">
<code class="code">assemble project</code> runs the default assemblage command line
    tool with the assemble file <code class="code">file</code> (defaults to <code class="code">assemble.ml</code>.<br>
</div>

<pre><span id="VAL(/)"><span class="keyword">val</span> (/)</span> : <code class="type">string -> string -> string</code></pre><div class="info ">
Same as <code class="code"><span class="constructor">Filename</span>.concat</code>.<br>
</div>
</body></html>